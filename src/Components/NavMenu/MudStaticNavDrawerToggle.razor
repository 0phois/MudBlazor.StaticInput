@using Microsoft.JSInterop
@namespace MudBlazor.StaticInput

@inherits MudIconButton

@{
    base.BuildRenderTree(__builder);
}

@code {
    /// <summary>
    /// The id of the <see cref="MudDrawer"/> to toggle
    /// </summary>
    /// <remarks>
    /// If not provided, the first mud-drawer element located within the DOM is used.
    /// </remarks>
    [Parameter]
    public string? DrawerId { get; set; } = "_no_id_provided_";

    protected override void OnParametersSet()
    {
        if (IsStatic())
        {
            UserAttributes["data-mud-static-type"] = "drawer-toggle";
            UserAttributes["data-mud-static-drawer-toggle"] = DrawerId;
        }
        else
        {
            UserAttributes.Remove("data-mud-static-type");
            UserAttributes.Remove("data-mud-static-drawer-toggle");
            UserAttributes.Remove("data-mud-static-initialized");

            base.OnClick = EventCallback.Factory.Create<MouseEventArgs>(this, async () =>
            {
                Open = !Open;
                await OpenChanged.InvokeAsync(Open);
                await JsRuntime.InvokeVoidAsync("MudDrawerInterop.setDrawerState", DrawerId, Open);
            });
        }

        base.OnParametersSet();
    }
}
